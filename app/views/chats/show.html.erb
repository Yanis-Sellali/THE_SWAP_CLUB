<div class="container py-4" style="max-width: 700px;">
  <!-- En-tête du chat -->
  <div class="d-flex align-items-center mb-4 border-bottom pb-3">
    <% if @other_user.avatar.attached? %>
      <%= image_tag url_for(@other_user.avatar), class: "rounded-circle me-3", alt: "Profil", style: "width: 50px; height: 50px; object-fit: cover;" %>
    <% else %>
      <%= image_tag "default_avatar.jpg", class: "rounded-circle me-3", width: 50, height: 50, alt: "Profil" %>
    <% end %>
    <div>
      <h5 class="mb-0"><%= @other_user.nom.presence || @other_user.email %></h5>
      <small class="text-muted">En ligne</small> <!-- À adapter si besoin -->
    </div>
  </div>

	<%= turbo_stream_from @chat %>
	<div id="messages">f
		<% @chat.messages.each do |message| %>
		 <% if message.trade_offer? %>
			 <%= render "messages/trade_offer_card", message:message %>
		 <% end %>
			<%= render "messages/message", message: message, current_user: current_user %>
		<% end %>
	</div>


  <!-- Formulaire d'envoi -->
  <%= form_with model: [@exchange, @chat, @message], local: true, data: { turbo: false }, id: "message-form" do |form| %>
    <div class="input-group">
      <%= form.text_area :content, class: "form-control", rows: 2, placeholder: "Écris ton message..." %>
      <button class="btn btn-primary" type="submit">Envoyer</button>
    </div>
  <% end %>
</div>

<div class="trade-offer-card border rounded p-4 bg-white shadow-sm text-center my-4">
  <h5 class="fw-bold mb-4">ğŸ“¦ Proposition dâ€™Ã©change</h5>

  <div class="d-flex justify-content-center align-items-center gap-4 mb-4">
    <div class="jersey">
      <% if message.offer_jersey_user1&.image&.attached? %>
        <%= image_tag message.offer_jersey_user1.image, class: "img-fluid rounded", style: "max-height: 160px;" %>
      <% end %>
      <p class="mt-2 fw-semibold"><%= message.offer_jersey_user1&.name %></p>
    </div>

    <div class="exchange-icon display-5">ğŸ”</div>

    <div class="jersey">
      <% if message.offer_jersey_user2&.image&.attached? %>
        <%= image_tag message.offer_jersey_user2.image, class: "img-fluid rounded", style: "max-height: 160px;" %>
      <% end %>
      <p class="mt-2 fw-semibold"><%= message.offer_jersey_user2&.name %></p>
    </div>
  </div>

  <% if message.accepted_by?(current_user) %>
    <% if message.both_accepted? %>
      <p class="text-success fw-bold">âœ… Les deux utilisateurs ont acceptÃ© lâ€™Ã©change !</p>
      <p class="text-muted fst-italic">Discutez ici pour fixer un lieu de rendez-vous et Ã©changer vos coordonnÃ©es.</p>

      <% unless message.finalized_by?(current_user) %>
        <%= button_to "ğŸ“ Finaliser lâ€™Ã©change", finalize_offer_message_path(message), method: :post, class: "btn btn-outline-primary mt-3 px-4" %>
      <% else %>
        <% if message.both_finalized? %>
          <p class="text-success mt-3 fw-bold">âœ… Ã‰change finalisÃ©, redirection en cours...</p>
        <% else %>
          <p class="text-warning mt-3">ğŸ•“ En attente de lâ€™autre utilisateur pour finaliser.</p>
        <% end %>
      <% end %>
    <% else %>
      <p class="text-warning fw-bold">ğŸ•“ En attente de la rÃ©ponse de lâ€™autre utilisateurâ€¦</p>
    <% end %>
  <% else %>
    <div class="d-flex justify-content-center gap-3">
      <%= button_to "âœ… Accepter lâ€™Ã©change", accept_offer_message_path(message), method: :post, class: "btn btn-success px-4" %>
      <%= button_to "âŒ Refuser", decline_offer_message_path(message), method: :post, class: "btn btn-danger px-4" %>
    </div>
  <% end %>
</div>

